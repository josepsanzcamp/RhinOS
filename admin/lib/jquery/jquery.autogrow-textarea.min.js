!function(e){e.fn.autogrow=function(t){return this.filter("textarea").each((function(){var n=this,a=e(n),o=a.height(),r=a.hasClass("autogrow-short")?0:parseInt(a.css("lineHeight"))||0,l=e.extend({preGrowCallback:null,postGrowCallback:null},t),i=e("<div></div>").css({position:"absolute",top:-1e4,left:-1e4,width:a.width(),fontSize:a.css("fontSize"),fontFamily:a.css("fontFamily"),fontWeight:a.css("fontWeight"),lineHeight:a.css("lineHeight"),resize:"none","word-wrap":"break-word"}).appendTo(document.body),s=function(e){var t=n.value.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/\n$/,"<br/>&nbsp;").replace(/\n/g,"<br/>").replace(/ {2,}/g,(function(e){return function(e,t){for(var n=0,a="";n<t;n++)a+=e;return a}("&nbsp;",e.length-1)+" "}));e&&e.data&&"keydown"===e.data.event&&13===e.keyCode&&(t+="<br />"),i.css("width",a.width()),i.html(t+(0===r?"...":""));var s=Math.max(i.height()+r,o);null!=l.preGrowCallback&&(s=l.preGrowCallback(a,i,s,o)),a.height(s),null!=l.postGrowCallback&&l.postGrowCallback(a)};a.change(s).keyup(s).keydown({event:"keydown"},s),e(window).resize(s),s()}))}}(jQuery);
